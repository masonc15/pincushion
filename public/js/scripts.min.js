!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);throw(f=new Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",f}c=n[i]={exports:{}},e[i][0].call(c.exports,function(r){return o(e[i][1][r]||r)},c,c.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";function _typeof(o){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(o)}var url_params,submit_error_timer,field_error_timer,bookmark,existingTags,submission_block_timer,API_ENDPOINT,Ladda=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};nodeInterop=_getRequireWildcardCache(nodeInterop);if(nodeInterop&&nodeInterop.has(obj))return nodeInterop.get(obj);var key,newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(key in obj){var desc;"default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)&&((desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null)&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key])}newObj.default=obj,nodeInterop&&nodeInterop.set(obj,newObj);return newObj}(require("ladda")),_openai=(require=require("openai"))&&require.__esModule?require:{default:require};function _getRequireWildcardCache(nodeInterop){var cacheBabelInterop,cacheNodeInterop;return"function"!=typeof WeakMap?null:(cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap,(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop))}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function(t,e,r){return t[e]=r}}function wrap(t,e,r,n){e=e&&e.prototype instanceof Generator?e:Generator,e=Object.create(e.prototype),n=new Context(n||[]);return o(e,"_invoke",{value:makeInvokeMethod(t,r,n)}),e}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var i={},d=(define(i,a,function(){return this}),Object.getPrototypeOf),d=d&&d(d(values([]))),g=(d&&d!==r&&n.call(d,a)&&(i=d),GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(i));function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t)})})}function AsyncIterator(t,e){function invoke(r,o,i,a){var u,r=tryCatch(t[r],t,o);if("throw"!==r.type)return(o=(u=r.arg).value)&&"object"==_typeof(o)&&n.call(o,"__await")?e.resolve(o.__await).then(function(t){invoke("next",t,i,a)},function(t){invoke("throw",t,i,a)}):e.resolve(o).then(function(t){u.value=t,i(u)},function(t){return invoke("throw",t,i,a)});a(r.arg)}var r;o(this,"_invoke",{value:function(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw new Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){c=function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=tryCatch(o,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(c,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;c=tryCatch(e,r,n);if("normal"===c.type){if(o=n.done?s:l,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=s,n.method="throw",n.arg=c.arg)}}}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var o,r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return o=-1,(r=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next}).next=r}throw new TypeError(_typeof(e)+" is not iterable")}return o(g,"constructor",{value:GeneratorFunction.prototype=GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this}),define(g,"toString",function(){return"[object Generator]"}),e.keys=function(t){var n,e=Object(t),r=[];for(n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;0<=o;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}var a=(i=i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc?null:i)?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,o,r=this.tryEntries[e];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(o=n.arg,resetTryEntry(r)),o}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function display_critical_error(message){alert(message),$(".helptext").remove(),$("#submit").addClass("fail"),$("#submit").prop("disabled",!0),$("#mainspinner").addClass("hidden")}function auth_token(){return url_params.user+":"+url_params.token}function showBookmarkTimestamp(date){$("#bookmark-status").attr("title",moment(date).format("dddd, MMMM Do YYYY, h:mma")).text("Originally saved "+moment(date).fromNow())}function leave_a_gap(){$("textarea#description").val($.trim($("textarea#description").val())),""!==$("textarea#description").val()&&($("textarea#description").val($("textarea#description").val()+"\n\n"),$("textarea#description").animate({scrollTop:"800"},1e3))}function remove_error_state_after_delay(){clearTimeout(submit_error_timer),clearTimeout(field_error_timer),submit_error_timer=setTimeout(function(){$("#submit").removeClass("fail"),$("#submit span.text").text($("#submit").data("stateText"))},1500),field_error_timer=setTimeout(function(){$("label span.helptext").fadeOut(300,function(){$(this).remove(),$("label").removeClass("error")})},2900)}function populate_dropdown(){var user_tags;localStorage&&localStorage.tags&&(user_tags=JSON.parse(localStorage.tags),console.log("Populating dropdown with "+Object.keys(user_tags).length.toLocaleString()+" tags."),$.each(user_tags,function(key,value){$("input#tags")[0].selectize.addOption({label:key,normalised_label:key.replace(/[&-_\[\]#,+()$~%.'":*?<>{}]/g,""),count:value})}))}function add_tag_remove_button_handlers(selector){selector.on("click",function(event){event.preventDefault(),event=$(this).text(),event=event=(event=(event=event.replace(/\\/g,"\\\\")).replace(/'/g,"\\'")).replace(/"/g,"&quot;"),$("input#tags")[0].selectize.addOption({label:event}),$("input#tags")[0].selectize.addItem(event),$(this).hide(100,function(){$(this).remove(),remove_suggested_tag_separator(),check_if_suggested_tags_are_empty()})})}function check_if_suggested_tags_are_empty(){remove_suggested_tag_separator(),0===$("#suggestion_row th").length&&($("#suggestion_row th").hide(300),$("#suggested").addClass("none").text("No suggested tags for this page."))}function activate_suggested_tags(){remove_suggested_tag_separator(),0===$("#suggested button").length&&$("#suggested").removeClass("none").text(""),$("#suggestion_row th").text("suggested tags")}function append_suggested_tag(tag){activate_suggested_tags(),$("#suggested").prepend('<button type="button" class="suggested_tag">'+pin_cook(tag)+"</button>"),add_tag_remove_button_handlers($("#suggested button:first"))}function remove_suggested_tag_separator(){0<$("#suggested").children().length&&("HR"===$("#suggested").children(":visible").first()[0].tagName||"HR"===$("#suggested").children(":visible").last()[0].tagName)&&$("#suggested hr").hide(200,function(){$(this).remove()}),0===$("#suggested button").length&&($("#suggestion_row th").hide(300),$("#suggested").addClass("none").text("No more suggested tags for this page."))}function display_reload_button(){$("#mainspinner").replaceWith('<button id="reload"><i class="fa fa-repeat"></i></button>'),$("#reload").click(function(event){event.preventDefault(),$(this).addClass("active"),window.location.reload()})}function download_user_tags(){console.log("Downloading user’s tags...");var all_tags_api=API_ENDPOINT+"tags/get?format=json&auth_token="+auth_token();$.get(all_tags_api).done(function(response){localStorage.tags=JSON.stringify(response),localStorage["tags-updated"]=new Date,console.log("Downloaded tags."),populate_dropdown()}).fail(function(response){401===response.status&&display_critical_error("401 Unauthorised. Please check the username and API access token you provided.")})}function pin_cook(s){return s=(s=(s=(s=s.replace(/^\s+|\s+$/g,"")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;")}function clean_url(url){return url=url.replace(/#.*$/,""),encodeURIComponent(url)}function queryGPTForTags(){return _queryGPTForTags.apply(this,arguments)}function _queryGPTForTags(){var fn;return fn=_regeneratorRuntime().mark(function _callee(){var completion,openai,contextInputs;return _regeneratorRuntime().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(url_params.openai_token){_context.next=2;break}return _context.abrupt("return");case 2:return openai=new _openai.default({apiKey:url_params.openai_token,dangerouslyAllowBrowser:!0}),existingTags=bookmark?bookmark.tags:"",contextInputs={url:url_params.url,title:url_params.title,description:url_params.description,existingTags:existingTags},_context.next=8,openai.chat.completions.create({model:"gpt-4o",max_tokens:250,temperature:.4,messages:[{role:"system",content:"Return a comma-separated list containing suggested tags to use for bookmarking a page on the web. You will be provided an URL, and sometimes a title, a description or snippet from the page, and list of existing tags.  The format of your response should be a comma-separated list, for example: spying, russia, 1980s, nuclear_war, cold_war, history\nThe tags you suggest should all be in lowercase, with no surrounding whitespace. Use underscores instead of spaces to combine words if necessary. Avoid punctuation marks.\nThink of the key concepts, people, subjects, brands, years/decades, publishers, websites, related concepts, etc. that are likely to be relevant to the page. Think of related or alternative concepts so you're not locked into a single meaning or interpretation. Don't over-emphasise the content of the description field, as this may just be a single paragraph or user comment from the page. There should be up to 14 tags, but only include ones that you are sure are relevant. Aim for at least 6. If you can't think of any tags, return an empty array. Remove any duplicate tags, or ones that are already present in the list of existing tags (the existingTags field). Finally, sort the tags and return them in ascending order of relevance."},{role:"user",content:"Here are my inputs: "+JSON.stringify(contextInputs)},{role:"assistant",content:"Here are my tag suggestions: "}]});case 8:if(0===(completion=_context.sent).choices.length)return _context.abrupt("return");_context.next=11;break;case 11:return openai=completion.choices[0].message.content,(contextInputs=openai.replace(/^\s+|\s+$/g,"")).endsWith(",")&&(contextInputs=contextInputs.slice(0,-1)),contextInputs.split(",").forEach(function(suggested_tag){append_suggested_tag(suggested_tag)}),_context.abrupt("return",openai);case 17:case"end":return _context.stop()}},_callee)}),(_queryGPTForTags=function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)})}).apply(this,arguments)}submission_block_timer=!1,API_ENDPOINT="https://pinboard-api.herokuapp.com/",$(function(){var bookmark_details_api;window.outerHeight<750&&window.resizeTo(600,750),$(document).keydown(function(e){!function(e){27===e.keyCode&&window.close()}(e)}),(window.onpopstate=function(){function decode(s){return decodeURIComponent(s.replace(pl," "))}var match,pl=/\+/g,search=/([^&=]+)=?([^&]*)/g,query=window.location.search.substring(1);for(url_params={};match=search.exec(query);)url_params[decode(match[1])]=decode(match[2])})(),url_params.url&&-1!==url_params.url.indexOf("#")&&($("input#url").addClass("hash-detected"),setTimeout(function(){$("input#url").after('<button id="remove-hash" class="fa fa-hashtag" title="Remove hash from URL"></button>'),$("#remove-hash").click(function(event){event.preventDefault(),$("input#url").val($("input#url").val().replace(/#.*$/,"")),$(this).slideUp(200),setTimeout(function(){$("input#url").removeClass("hash-detected")},200)})},300)),$("input#url").val(url_params.url),$("input#title").val(function(title_string){return title_string?title_string.replace(/^▶ /,""):""}(url_params.title)),$("textarea#description").val($.trim(url_params.description)),$("input#private").prop("checked","true"===url_params.private),$("input#toread").prop("checked","true"===url_params.private),leave_a_gap(),url_params.user&&url_params.token||display_critical_error("You must provide both ‘user’ and ‘token’ parameters to this page to allow it to use the Pinboard API."),$("input#tags").selectize({delimiter:" ",create:!0,openOnFocus:!1,maxOptions:15,persist:!0,createOnBlur:!1,hideSelected:!0,selectOnTab:!1,diacritics:!0,valueField:"label",labelField:"label",searchField:["label","normalised_label"],score:function(search){var score=this.getScoreFunction(search);return function(item){return score(item)*(1+item.count/100)}},plugins:{remove_button:{title:"Remove this tag"}},onEnterKeypress:function(){!1===submission_block_timer&&$("#submit").click()},onChange:function(){$("input#tags")[0].selectize.close(),submission_block_timer=!0,setTimeout(function(){submission_block_timer=!1},10)},onItemAdd:function(value,$item){$(".suggested_tag").each(function(){$(this).text()===value&&$(this).hide(400,function(){$(this).remove(),remove_suggested_tag_separator()})}),$("input#tags")[0].selectize.close()},onItemRemove:function(value,$item){append_suggested_tag(value)},render:{option:function(data,escape){var count=void 0!==data.count?escape(data.count):"0";return'\n            <div class="item">\n              '.concat(escape(data.label),'\n              <span class="optioncount ').concat(function(count){switch(!0){case 100<count:return"tw100";case 50<count:return"tw50";case 10<count:return"tw10";case 1<count:return"tw1"}}(escape(data.count)),'">\n                ').concat(count,"\n              </span>\n            </div>")}}}),populate_dropdown(),$("#post-to-pinboard").on("submit",function(event){event.preventDefault(),$("#submit span.text").html("Saving bookmark&hellip;");event=API_ENDPOINT+"posts/add?format=json&auth_token="+auth_token()+"&"+function(){$("#description").val($.trim($("#description").val()));var serialized_form_inputs=$("#url, #title, #description, #tags").serialize();$("#private").prop("checked")&&(serialized_form_inputs+="&shared=no");$("#toread").prop("checked")&&(serialized_form_inputs+="&toread=yes");return serialized_form_inputs}();$.ajax({type:"GET",url:event,timeout:25e3}).done(function(response){if("done"===response.result_code){console.log("Bookmark saved correctly."),Ladda.stopAll(),$("#submit").addClass("success"),$("#submit span.text").text("Bookmark saved!");for(var user_tags=JSON.parse(localStorage.tags),potentially_new_tags=$("input#tags").val().split(" "),i=0;i<potentially_new_tags.length;i++)user_tags[potentially_new_tags[i]]?$("input#tags").data("previous_tags")&&-1!==$("input#tags").data("previous_tags").indexOf(potentially_new_tags[i])||(user_tags[potentially_new_tags[i]]=parseInt(user_tags[potentially_new_tags[i]])+1):user_tags[potentially_new_tags[i]]=1;localStorage.tags=JSON.stringify(user_tags),localStorage["tags-updated"]=new Date,setTimeout(function(){window.close(),setTimeout(function(){$("#submit").removeClass("success"),$("#submit span.text").text($("#submit").data("stateText")),showBookmarkTimestamp(new Date)},300)},900)}else Ladda.stopAll(),$(".helptext").remove(),$("#submit").addClass("fail"),"missing url"===response.result_code&&($("label[for=url]").addClass("error").append('<span class="helptext"> is required</span>'),$("#url").focus()),"must provide title"===response.result_code&&($("label[for=title]").addClass("error").append('<span class="helptext"> is required</span>'),$("#title").focus()),$(".helptext").fadeIn(),remove_error_state_after_delay()}).fail(function(response){Ladda.stopAll(),$(".helptext").remove(),$("#submit").addClass("fail"),0===response.status&&"error"===response.statusText&&(alert("Cross-domain request failed. Your connection may have dropped, or the request may be too long; please try shortening the description text."),display_reload_button()),414===response.status&&($("label[for=description]").addClass("error").append('<span class="helptext"> is too long</span>'),$("#description").addClass("expanded"),$("#description").focus()),401===response.status&&display_critical_error("401 Unauthorised. Please check the username and API access token you provided."),$(".helptext").fadeIn(),remove_error_state_after_delay()})}),$("input, textarea").on("blur",function(){$("body").animate({scrollTop:0},200)}),"ontouchstart"in window||$("input#tags")[0].selectize.focus(),$("textarea#description").on("blur",function(){leave_a_gap()}),$("#private").on("change",function(){!0===$("#private").prop("checked")?$("body").addClass("private"):$("body").removeClass("private")}),Ladda.bind("button[type=submit]"),url_params.url&&(bookmark_details_api=API_ENDPOINT+"posts/get?format=json&auth_token="+auth_token()+"&url="+clean_url(url_params.url),$.support.cors=!0,$.get(bookmark_details_api).done(function(response){if($("#mainspinner").addClass("hidden"),$("#submit").data("stateText","Add bookmark"),1!==response.posts.length)queryGPTForTags().then(console.log).catch(console.error);else{bookmark=response.posts[0],queryGPTForTags().then(console.log).catch(console.error),$("input#title").val(bookmark.description),bookmark.extended&&$.trim(bookmark.extended)!==$.trim(url_params.description)&&$("textarea#description").val($.trim(bookmark.extended)+"\n\n"+$.trim(url_params.description)),leave_a_gap();response=bookmark.tags;if(""!=response){$("input#tags").data("previous_tags",response);for(var tags=response.split(" "),i=0;i<tags.length;i++)$("input#tags")[0].selectize.addOption({label:tags[i]}),$("input#tags")[0].selectize.addItem(tags[i]),$("input#tags")[0].selectize.close();$("#suggested button").filter(function(){return $(this).text().toLowerCase()===tags[i]}).remove()}"no"===bookmark.shared?$("#private").prop("checked",!0).change():$("#private").prop("checked",!1),"yes"===bookmark.toread?$("#toread").prop("checked",!0):$("#toread").prop("checked",!1),bookmark.time&&showBookmarkTimestamp(new Date(bookmark.time)),$("#submit").data("stateText","Update bookmark"),$("#submit span.text").text("Update bookmark")}}).fail(function(response){0===response.status&&(response.statusText,1)&&(display_critical_error("Cross-domain request failed. Your browser is denying this request from being sent."),display_reload_button()),401===response.status&&display_critical_error("401 Unauthorised. Please check the username and API access token you provided.")})),url_params.url&&(bookmark_details_api=API_ENDPOINT+"posts/suggest?format=json&auth_token="+auth_token()+"&url="+clean_url(url_params.url),$("#tagspinner").removeClass("hidden"),$.get(bookmark_details_api).done(function(response){var tag_suggestions=response;if(tag_suggestions){tag_suggestions=(tag_suggestions=$.merge(tag_suggestions[1].recommended,tag_suggestions[0].popular)).map(function(tag){return tag.toLowerCase()}),tag_suggestions=function(tag_suggestions){var ranked_tags,user_tags,separator;return localStorage&&localStorage.tags?(ranked_tags=[],user_tags=JSON.parse(localStorage.tags),separator=!0,$.each(tag_suggestions,function(index,tag){user_tags.hasOwnProperty(tag)?(separator&&(ranked_tags.unshift("$separator"),separator=!1),ranked_tags.unshift(tag)):ranked_tags.push(tag)}),ranked_tags):tag_suggestions}(tag_suggestions=function(tag_suggestions){var ignored_tags=["bookmarks_bar","pin-later","unread","*resources","unlabeled","via:packrati.us","bookmarks_menu",".from:twitter","twitterlink","from","ifttt","later","saved","read","feedly","for","recently","tobookmarks","from:ifttt","instapaper","!fromtwitter","feedbin","favorites_bar","imported",".dailybrowse","barra_dei_preferiti","bookmarks_toolbar","via:pocket","from_pocket","pocket","archive","toread","readlater","via:popular","!tweet","twitter-fav","created-by:ifttt","starred","soon","riposte","github:starred","iftttfeedly","github-starred-to-pinboard","appdotnet","top","instapaper:","&amp;","(popular","--","bookmarks)","from:feedly","from:rss","instapaper:import","instapaper:starred","*","**","***","instapaper:import","googlereader","no_tag","evernote-web-clipper"];return tag_suggestions=$.grep(tag_suggestions,function(tag){return-1===$.inArray(tag.toLowerCase(),ignored_tags)}),tag_suggestions=$.grep(tag_suggestions,function(tag){return null===tag.toLowerCase().match(/^via:/)})}(tag_suggestions=function(tag_suggestions){return["ifttt","facebook","youtube","objective-c","twitter","twitterlink","wsh",".from:twitter","@codepo8","1960s"].every(function(tag){return tag_suggestions.includes(tag)})?[]:tag_suggestions}(tag_suggestions=$.grep(tag_suggestions,function(v,k){return $.inArray(v,tag_suggestions)===k}))));for(var suggested_tags=[],i=0;i<tag_suggestions.length;i++)"$separator"===tag_suggestions[i]?suggested_tags.push("<hr>"):-1===(" "+$("#tags").val().toLowerCase()+" ").indexOf(" "+tag_suggestions[i]+" ")&&suggested_tags.push('<button type="button" class="suggested_tag">'+pin_cook(tag_suggestions[i])+"</button>");(0<suggested_tags.length?($("#suggested").append(suggested_tags.join("")),add_tag_remove_button_handlers($("#suggested button")),activate_suggested_tags(),remove_suggested_tag_separator):check_if_suggested_tags_are_empty)()}$("#tagspinner").addClass("hidden")}).fail(function(response){$("#suggestion_row th").hide(800),$("#tagspinner").hide(300)})),localStorage&&(localStorage.tags?(console.log("Have a record of tags already, setting up delayed download."),setTimeout(function(){download_user_tags()},1e4)):download_user_tags())}),RegExp.escape=function(text){return text.replace(/[-[\]{}()*+?.,\\\\'"^$|#\s]/g,"\\$&")}},{ladda:5,openai:13}],2:[function(require,module,exports){"use strict";exports.byteLength=function(b64){var b64=getLens(b64),validLen=b64[0],b64=b64[1];return 3*(validLen+b64)/4-b64},exports.toByteArray=function(b64){var tmp,i,lens=getLens(b64),validLen=lens[0],lens=lens[1],arr=new Arr(function(validLen,placeHoldersLen){return 3*(validLen+placeHoldersLen)/4-placeHoldersLen}(validLen,lens)),curByte=0,len=0<lens?validLen-4:validLen;for(i=0;i<len;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[curByte++]=tmp>>16&255,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp;2===lens&&(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[curByte++]=255&tmp);1===lens&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp);return arr},exports.fromByteArray=function(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(function(uint8,start,end){for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(255&uint8[i+2]),output.push(function(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]}(tmp));return output.join("")}(uint8,i,len2<i+16383?len2:i+16383));1==extraBytes?(tmp=uint8[len-1],parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")):2==extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"="));return parts.join("")};for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(b64){var len=b64.length;if(0<len%4)throw new Error("Invalid string. Length must be a multiple of 4");b64=b64.indexOf("="),len=(b64=-1===b64?len:b64)===len?0:4-b64%4;return[b64,len]}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},{}],3:[function(require,module,exports){!function(Buffer){!function(){"use strict";var base64=require("base64-js"),ieee754=require("ieee754"),K_MAX_LENGTH=(exports.Buffer=Buffer,exports.SlowBuffer=function(length){+length!=length&&(length=0);return Buffer.alloc(+length)},exports.INSPECT_MAX_BYTES=50,2147483647);function createBuffer(length){if(K_MAX_LENGTH<length)throw new RangeError('The value "'+length+'" is invalid for option "size"');length=new Uint8Array(length);return length.__proto__=Buffer.prototype,length}function Buffer(arg,encodingOrOffset,length){if("number"!=typeof arg)return from(arg,encodingOrOffset,length);if("string"==typeof encodingOrOffset)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(arg)}function from(value,encodingOrOffset,length){if("string"==typeof value)return function(string,encoding){"string"==typeof encoding&&""!==encoding||(encoding="utf8");if(!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);var length=0|byteLength(string,encoding),buf=createBuffer(length),string=buf.write(string,encoding);string!==length&&(buf=buf.slice(0,string));return buf}(value,encodingOrOffset);if(ArrayBuffer.isView(value))return fromArrayLike(value);if(null==value)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value);if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer))return function(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset)throw new RangeError('"offset" is outside of buffer bounds');if(array.byteLength<byteOffset+(length||0))throw new RangeError('"length" is outside of buffer bounds');array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length);return array.__proto__=Buffer.prototype,array}(value,encodingOrOffset,length);if("number"==typeof value)throw new TypeError('The "value" argument must not be of type number. Received type number');var valueOf=value.valueOf&&value.valueOf();if(null!=valueOf&&valueOf!==value)return Buffer.from(valueOf,encodingOrOffset,length);valueOf=function(obj){{var len,buf;if(Buffer.isBuffer(obj))return len=0|checked(obj.length),0!==(buf=createBuffer(len)).length&&obj.copy(buf,0,0,len),buf}if(void 0!==obj.length)return"number"!=typeof obj.length||numberIsNaN(obj.length)?createBuffer(0):fromArrayLike(obj);if("Buffer"===obj.type&&Array.isArray(obj.data))return fromArrayLike(obj.data)}(value);if(valueOf)return valueOf;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof value[Symbol.toPrimitive])return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be of type number');if(size<0)throw new RangeError('The value "'+size+'" is invalid for option "size"')}function allocUnsafe(size){return assertSize(size),createBuffer(size<0?0:0|checked(size))}function fromArrayLike(array){for(var length=array.length<0?0:0|checked(array.length),buf=createBuffer(length),i=0;i<length;i+=1)buf[i]=255&array[i];return buf}function checked(length){if(K_MAX_LENGTH<=length)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|length}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer))return string.byteLength;if("string"!=typeof string)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof string);var len=string.length,mustMatch=2<arguments.length&&!0===arguments[2];if(!mustMatch&&0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return mustMatch?-1:utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((start=void 0===start||start<0?0:start)>this.length)return"";if((end=void 0===end||end>this.length?this.length:end)<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding=encoding||"utf8";;)switch(encoding){case"hex":return function(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0);(!end||end<0||len<end)&&(end=len);for(var out="",i=start;i<end;++i)out+=function(n){return n<16?"0"+n.toString(16):n.toString(16)}(buf[i]);return out}(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return function(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}(this,start,end);case"latin1":case"binary":return function(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}(this,start,end);case"base64":return function(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):2147483647<byteOffset?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),(byteOffset=(byteOffset=numberIsNaN(byteOffset=+byteOffset)?dir?0:buffer.length-1:byteOffset)<0?buffer.length+byteOffset:byteOffset)>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,"function"==typeof Uint8Array.prototype.indexOf?(dir?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;arrLength/=indexSize=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir)for(var foundIndex=-1,i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(i-(foundIndex=-1===foundIndex?i:foundIndex)+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1;else for(i=byteOffset=arrLength<byteOffset+valLength?arrLength-valLength:byteOffset;0<=i;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function asciiWrite(buf,string,offset,length){return blitBuffer(function(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(function(str,units){for(var c,hi,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,byteArray.push(c%256),byteArray.push(hi);return byteArray}(string,buf.length-offset),buf,offset,length)}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var secondByte,thirdByte,fourthByte,tempCodePoint,firstByte=buf[i],codePoint=null,bytesPerSequence=239<firstByte?4:223<firstByte?3:191<firstByte?2:1;if(i+bytesPerSequence<=end)switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&127<(tempCodePoint=(31&firstByte)<<6|63&secondByte)&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&2047<(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)&&(tempCodePoint<55296||57343<tempCodePoint)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&65535<(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}null===codePoint?(codePoint=65533,bytesPerSequence=1):65535<codePoint&&(res.push((codePoint-=65536)>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return function(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);var res="",i=0;for(;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}(res)}exports.kMaxLength=K_MAX_LENGTH,(Buffer.TYPED_ARRAY_SUPPORT=function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=from,Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,Buffer.alloc=function(size,fill,encoding){return assertSize(size),!(size<=0)&&void 0!==fill?"string"==typeof encoding?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill):createBuffer(size)},Buffer.allocUnsafe=allocUnsafe,Buffer.allocUnsafeSlow=allocUnsafe,Buffer.isBuffer=function(b){return null!=b&&!0===b._isBuffer&&b!==Buffer.prototype},Buffer.compare=function(a,b){if(isInstance(a,Uint8Array)&&(a=Buffer.from(a,a.offset,a.byteLength)),isInstance(b,Uint8Array)&&(b=Buffer.from(b,b.offset,b.byteLength)),!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!Array.isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);if(void 0===length)for(i=length=0;i<list.length;++i)length+=list[i].length;for(var buffer=Buffer.allocUnsafe(length),pos=0,i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array)&&(buf=Buffer.from(buf)),!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toLocaleString=Buffer.prototype.toString=function(){var length=this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(Buffer.isBuffer(b))return this===b||0===Buffer.compare(this,b);throw new TypeError("Argument must be a Buffer")},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES,str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim();return this.length>max&&(str+=" ... "),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)&&(target=Buffer.from(target,target.offset,target.byteLength)),!Buffer.isBuffer(target))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof target);if(void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),(start=void 0===start?0:start)<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisEnd<=thisStart&&end<=start)return 0;if(thisEnd<=thisStart)return-1;if(end<=start)return 1;if(this===target)return 0;for(var x=(thisEnd>>>=0)-(thisStart>>>=0),y=(end>>>=0)-(start>>>=0),len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset>>>=0,isFinite(length)?(length>>>=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||remaining<length)&&(length=remaining),0<string.length&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding=encoding||"utf8";for(var loweredCase=!1;;)switch(encoding){case"hex":return function(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;(!length||remaining<(length=Number(length)))&&(length=remaining),(remaining=string.length)/2<length&&(length=remaining/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}(this,string,offset,length);case"utf8":case"utf-8":return function(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return asciiWrite(this,string,offset,length);case"base64":return function(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(length<offset+ext)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(max<value||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function checkIEEE754(buf,value,offset,ext){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,4),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,8),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function(start,end){var len=this.length,len=((start=~~start)<0?(start+=len)<0&&(start=0):len<start&&(start=len),(end=void 0===end?len:~~end)<0?(end+=len)<0&&(end=0):len<end&&(end=len),end<start&&(end=start),this.subarray(start,end));return len.__proto__=Buffer.prototype,len},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;0<byteLength&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return(mul*=128)<=val&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];0<i&&(mul*=256);)val+=this[offset+--i]*mul;return(mul*=128)<=val&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);noAssert=this[offset]|this[offset+1]<<8;return 32768&noAssert?4294901760|noAssert:noAssert},Buffer.prototype.readInt16BE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);noAssert=this[offset+1]|this[offset]<<8;return 32768&noAssert?4294901760|noAssert:noAssert},Buffer.prototype.readInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;0<=--i&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value,offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,byteLength,(noAssert=Math.pow(2,8*byteLength-1))-1,-noAssert);var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,byteLength,(noAssert=Math.pow(2,8*byteLength-1))-1,-noAssert);var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;0<=--i&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),this[offset]=255&(value=value<0?255+value+1:value),offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24,offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=(value=value<0?4294967295+value+1:value)>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(start=start||0,end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),(end=0<end&&end<start?start:end)===start)return 0;if(0===target.length||0===this.length)return 0;if((targetStart=targetStart||0)<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length);var len=(end=target.length-targetStart<end-start?target.length-targetStart+start:end)-start;if(this===target&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(targetStart,start,end);else if(this===target&&start<targetStart&&targetStart<end)for(var i=len-1;0<=i;--i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);var code;1===val.length&&(code=val.charCodeAt(0),"utf8"===encoding&&code<128||"latin1"===encoding)&&(val=code)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");var i;if(!(end<=start))if(start>>>=0,end=void 0===end?this.length:end>>>0,"number"==typeof(val=val||0))for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding),len=bytes.length;if(0===len)throw new TypeError('The value "'+val+'" is invalid for argument "value"');for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if(55295<(codePoint=string.charCodeAt(i))&&codePoint<57344){if(!leadSurrogate){if(56319<codePoint){-1<(units-=3)&&bytes.push(239,191,189);continue}if(i+1===length){-1<(units-=3)&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){-1<(units-=3)&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&-1<(units-=3)&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if(--units<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return base64.toByteArray(function(str){if((str=(str=str.split("=")[0]).trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isInstance(obj,type){return obj instanceof type||null!=obj&&null!=obj.constructor&&null!=obj.constructor.name&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!=obj}}.call(this)}.call(this,require("buffer").Buffer)},{"base64-js":2,buffer:3,ieee754:4}],4:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,nBytes=buffer[offset+i];for(i+=d,e=nBytes&(1<<-nBits)-1,nBytes>>=-nBits,nBits+=eLen;0<nBits;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;0<nBits;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(nBytes?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(nBytes?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,nBytes=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(isLE=Math.pow(2,-e))<1&&(e--,isLE*=2),2<=(value+=1<=e+eBias?rt/isLE:rt*Math.pow(2,1-eBias))*isLE&&(e++,isLE/=2),eMax<=e+eBias?(m=0,e=eMax):1<=e+eBias?(m=(value*isLE-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));8<=mLen;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;0<eLen;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*nBytes}},{}],5:[function(require,module,exports){!function(t,e){"use strict";"object"==typeof exports?module.exports=e(require("spin.js")):"function"==typeof define&&define.amd?define(["spin"],e):t.Ladda=e(t.Spinner)}(this,function(t){"use strict";var e=[];function a(a){var n,u,r,d,o,s,F;if(void 0!==a)return/ladda-button/i.test(a.className)||(a.className+=" ladda-button"),a.hasAttribute("data-style")||a.setAttribute("data-style","expand-right"),a.querySelector(".ladda-label")||((u=document.createElement("span")).className="ladda-label",n=a,u=u,(r=document.createRange()).selectNodeContents(n),r.surroundContents(u),n.appendChild(u)),(s=a.querySelector(".ladda-spinner"))||((s=document.createElement("span")).className="ladda-spinner"),a.appendChild(s),F={start:function(){return d=d||function(e){var a,u,n=e.offsetHeight,e=(32<(n=0===n?parseFloat(window.getComputedStyle(e).height):n)&&(n*=.8),e.hasAttribute("data-spinner-size")&&(n=parseInt(e.getAttribute("data-spinner-size"),10)),e.hasAttribute("data-spinner-color")&&(a=e.getAttribute("data-spinner-color")),e.hasAttribute("data-spinner-lines")&&(u=parseInt(e.getAttribute("data-spinner-lines"),10)),.2*n);return new t({color:a||"#fff",lines:u||12,radius:e,length:.6*e,width:e<7?2:3,zIndex:"auto",top:"auto",left:"auto",className:""})}(a),a.disabled=!0,a.setAttribute("data-loading",""),clearTimeout(o),d.spin(s),this.setProgress(0),this},startAfter:function(t){return clearTimeout(o),o=setTimeout(function(){F.start()},t),this},stop:function(){return F.isLoading()&&(a.disabled=!1,a.removeAttribute("data-loading")),clearTimeout(o),d&&(o=setTimeout(function(){d.stop()},1e3)),this},toggle:function(){return this.isLoading()?this.stop():this.start()},setProgress:function(t){t=Math.max(Math.min(t,1),0);var e=a.querySelector(".ladda-progress");0===t&&e&&e.parentNode?e.parentNode.removeChild(e):(e||((e=document.createElement("div")).className="ladda-progress",a.appendChild(e)),e.style.width=(t||0)*a.offsetWidth+"px")},enable:function(){return this.stop()},disable:function(){return this.stop(),a.disabled=!0,this},isLoading:function(){return a.hasAttribute("data-loading")},remove:function(){clearTimeout(o),a.disabled=!1,a.removeAttribute("data-loading"),d&&(d.stop(),d=null),e.splice(e.indexOf(F),1)}},e.push(F),F;console.warn("Ladda button target must be defined.")}function u(t,e){var u,n;"function"==typeof t.addEventListener&&(u=a(t),n=-1,t.addEventListener("click",function(){var a,i,r=!0,d=function(t,e){for(;t.parentNode&&t.tagName!==e;)t=t.parentNode;return e===t.tagName?t:void 0}(t,"FORM");if(void 0!==d&&!d.hasAttribute("novalidate"))if("function"==typeof d.checkValidity)r=d.checkValidity();else{a=d,i=[],["input","textarea","select"].forEach(function(t){for(var e=a.getElementsByTagName(t),u=0;u<e.length;u++)e[u].hasAttribute("required")&&i.push(e[u])});for(var o=i,s=0;s<o.length;s++){var F=o[s],l=F.getAttribute("type");if(""===F.value.replace(/^\s+|\s+$/g,"")&&(r=!1),"checkbox"!==l&&"radio"!==l||F.checked||(r=!1),"email"===l&&(r=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i.test(F.value)),!(r="url"===l?/^([a-z]([a-z]|\d|\+|-|\.)*):(\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?((\[(|(v[\da-f]{1,}\.(([a-z]|\d|-|\.|_|~)|[!\$&'\(\)\*\+,;=]|:)+))\])|((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=])*)(:\d*)?)(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*|(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)){0})(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(F.value):r))break}}r&&(u.startAfter(1),"number"==typeof e.timeout&&(clearTimeout(n),n=setTimeout(u.stop,e.timeout)),"function"==typeof e.callback)&&e.callback.apply(null,[u])},!1))}return{bind:function(t,e){var a;if("string"==typeof t)a=document.querySelectorAll(t);else{if("object"!=typeof t)throw new Error("target must be string or object");a=[t]}e=e||{};for(var n=0;n<a.length;n++)u(a[n],e)},create:a,stopAll:function(){for(var t=0,a=e.length;t<a;t++)e[t].stop()}}})},{"spin.js":39}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultipartBody=void 0;class MultipartBody{constructor(body){this.body=body}get[Symbol.toStringTag](){return"MultipartBody"}}exports.MultipartBody=MultipartBody},{}],7:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&("get"in desc?m.__esModule:!desc.writable&&!desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){o[k2=void 0===k2?k:k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(require("../web-runtime.js"),exports)},{"../web-runtime.js":10}],8:[function(require,module,exports){const shims=require("./registry");require=require("openai/_shims/auto/runtime");shims.kind||shims.setShims(require.getRuntime(),{auto:!0});for(const property of Object.keys(shims))Object.defineProperty(exports,property,{get(){return shims[property]}})},{"./registry":9,"openai/_shims/auto/runtime":7}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setShims=exports.isFsReadStream=exports.fileFromPath=exports.getDefaultAgent=exports.getMultipartRequestOptions=exports.File=exports.Blob=exports.FormData=exports.Headers=exports.Response=exports.Request=exports.fetch=exports.kind=exports.auto=void 0,exports.auto=!1,exports.kind=void 0,exports.fetch=void 0,exports.Request=void 0,exports.Response=void 0,exports.Headers=void 0,exports.FormData=void 0,exports.Blob=void 0,exports.File=void 0,exports.getMultipartRequestOptions=void 0,exports.getDefaultAgent=void 0,exports.fileFromPath=void 0,exports.isFsReadStream=void 0,exports.setShims=function(shims,options={auto:!1}){if(exports.auto)throw new Error(`you must \`import 'openai/shims/${shims.kind}'\` before importing anything else from openai`);if(exports.kind)throw new Error(`can't \`import 'openai/shims/${shims.kind}'\` after \`import 'openai/shims/${exports.kind}'\``);exports.auto=options.auto,exports.kind=shims.kind,exports.fetch=shims.fetch,exports.Request=shims.Request,exports.Response=shims.Response,exports.Headers=shims.Headers,exports.FormData=shims.FormData,exports.Blob=shims.Blob,exports.File=shims.File,exports.getMultipartRequestOptions=shims.getMultipartRequestOptions,exports.getDefaultAgent=shims.getDefaultAgent,exports.fileFromPath=shims.fileFromPath,exports.isFsReadStream=shims.isFsReadStream}},{}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getRuntime=void 0;const MultipartBody_1=require("./MultipartBody.js");exports.getRuntime=function({manuallyImported}={}){const recommendation=manuallyImported?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let _fetch,_Request,_Response,_Headers;try{_fetch=fetch,_Request=Request,_Response=Response,_Headers=Headers}catch(error){throw new Error(`this environment is missing the following Web Fetch API type: ${error.message}. `+recommendation)}return{kind:"web",fetch:_fetch,Request:_Request,Response:_Response,Headers:_Headers,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'FormData' is undefined. "+recommendation)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'Blob' is undefined. "+recommendation)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'File' is undefined. "+recommendation)}},getMultipartRequestOptions:async(form,opts)=>({...opts,body:new MultipartBody_1.MultipartBody(form)}),getDefaultAgent:url=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:value=>!1}}},{"./MultipartBody.js":6}],11:[function(require,module,exports){!function(process,Buffer){!function(){"use strict";var _AbstractPage_client,__classPrivateFieldSet=this&&this.__classPrivateFieldSet||function(receiver,state,value,kind,f){if("m"===kind)throw new TypeError("Private method is not writable");if("a"===kind&&!f)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof state?receiver===state&&f:state.has(receiver))return"a"===kind?f.call(receiver,value):f?f.value=value:state.set(receiver,value),value;throw new TypeError("Cannot write private member to an object whose class did not declare it")},__classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(receiver,state,kind,f){if("a"===kind&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof state?receiver===state&&f:state.has(receiver))return"m"===kind?f:"a"===kind?f.call(receiver):f?f.value:state.get(receiver);throw new TypeError("Cannot read private member from an object whose class did not declare it")};Object.defineProperty(exports,"__esModule",{value:!0}),exports.toBase64=exports.getHeader=exports.isHeadersProtocol=exports.isRunningInBrowser=exports.debug=exports.hasOwn=exports.isEmptyObj=exports.maybeCoerceBoolean=exports.maybeCoerceFloat=exports.maybeCoerceInteger=exports.coerceBoolean=exports.coerceFloat=exports.coerceInteger=exports.readEnv=exports.ensurePresent=exports.castToError=exports.sleep=exports.safeJSON=exports.isRequestOptions=exports.createResponseHeaders=exports.PagePromise=exports.AbstractPage=exports.APIResource=exports.APIClient=exports.APIPromise=exports.createForm=exports.multipartFormRequestOptions=exports.maybeMultipartFormRequestOptions=void 0;const version_1=require("./version.js"),streaming_1=require("./streaming.js"),error_1=require("./error.js"),index_1=require("./_shims/index.js"),uploads_1=require("./uploads.js");var uploads_2=require("./uploads.js");Object.defineProperty(exports,"maybeMultipartFormRequestOptions",{enumerable:!0,get:function(){return uploads_2.maybeMultipartFormRequestOptions}}),Object.defineProperty(exports,"multipartFormRequestOptions",{enumerable:!0,get:function(){return uploads_2.multipartFormRequestOptions}}),Object.defineProperty(exports,"createForm",{enumerable:!0,get:function(){return uploads_2.createForm}});async function defaultParseResponse(props){var response=props["response"];return props.options.stream?new streaming_1.Stream(response,props.controller):null!=(props=response.headers.get("content-type"))&&props.includes("application/json")?(props=await response.json(),debug("response",response.status,response.url,response.headers,props),props):(props=await response.text(),debug("response",response.status,response.url,response.headers,props),props)}class APIPromise extends Promise{constructor(responsePromise,parseResponse=defaultParseResponse){super(resolve=>{resolve(null)}),this.responsePromise=responsePromise,this.parseResponse=parseResponse}_thenUnwrap(transform){return new APIPromise(this.responsePromise,async props=>transform(await this.parseResponse(props)))}asResponse(){return this.responsePromise.then(p=>p.response)}async withResponse(){var[data,response]=await Promise.all([this.parse(),this.asResponse()]);return{data:data,response:response}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(onfulfilled,onrejected){return this.parse().then(onfulfilled,onrejected)}catch(onrejected){return this.parse().catch(onrejected)}finally(onfinally){return this.parse().finally(onfinally)}}exports.APIPromise=APIPromise;exports.APIClient=class{constructor({baseURL,maxRetries,timeout=6e5,httpAgent,fetch:overridenFetch}){this.baseURL=baseURL,this.maxRetries=validatePositiveInteger("maxRetries",null!=maxRetries?maxRetries:2),this.timeout=validatePositiveInteger("timeout",timeout),this.httpAgent=httpAgent,this.fetch=null!=overridenFetch?overridenFetch:index_1.fetch}authHeaders(opts){return{}}defaultHeaders(opts){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...getPlatformHeaders(),...this.authHeaders(opts)}}validateHeaders(headers,customHeaders){}defaultIdempotencyKey(){return"stainless-node-retry-"+uuid4()}get(path,opts){return this.methodRequest("get",path,opts)}post(path,opts){return this.methodRequest("post",path,opts)}patch(path,opts){return this.methodRequest("patch",path,opts)}put(path,opts){return this.methodRequest("put",path,opts)}delete(path,opts){return this.methodRequest("delete",path,opts)}methodRequest(method,path,opts){return this.request(Promise.resolve(opts).then(opts=>({method:method,path:path,...opts})))}getAPIList(path,Page,opts){return this.requestAPIList(Page,{method:"get",path:path,...opts})}calculateContentLength(body){if("string"==typeof body){if(void 0!==Buffer)return Buffer.byteLength(body,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(body).length.toString()}return null}buildRequest(options){var _d,{method,path,query,headers={}}=options,body=(0,uploads_1.isMultipartBody)(options.body)?options.body.body:options.body?JSON.stringify(options.body,null,2):null,contentLength=this.calculateContentLength(body),path=this.buildURL(path,query),query=("timeout"in options&&validatePositiveInteger("timeout",options.timeout),null!=(query=options.timeout)?query:this.timeout),_b=null!=(_b=null!=(_b=options.httpAgent)?_b:this.httpAgent)?_b:(0,index_1.getDefaultAgent)(path),minAgentTimeout=query+1e3;"number"==typeof(null==(_d=null==_b?void 0:_b.options)?void 0:_d.timeout)&&minAgentTimeout>(null!=(_d=_b.options.timeout)?_d:0)&&(_b.options.timeout=minAgentTimeout),this.idempotencyHeader&&"get"!==method&&(options.idempotencyKey||(options.idempotencyKey=this.defaultIdempotencyKey()),headers[this.idempotencyHeader]=options.idempotencyKey);const reqHeaders={...contentLength&&{"Content-Length":contentLength},...this.defaultHeaders(options),...headers};(0,uploads_1.isMultipartBody)(options.body)&&"node"!==index_1.kind&&delete reqHeaders["Content-Type"],Object.keys(reqHeaders).forEach(key=>null===reqHeaders[key]&&delete reqHeaders[key]);minAgentTimeout={method:method,...body&&{body:body},headers:reqHeaders,..._b&&{agent:_b},signal:null!=(_d=options.signal)?_d:null};return this.validateHeaders(reqHeaders,headers),{req:minAgentTimeout,url:path,timeout:query}}async prepareRequest(request,{}){}parseHeaders(headers){return headers?Symbol.iterator in headers?Object.fromEntries(Array.from(headers).map(header=>[...header])):{...headers}:{}}makeStatusError(status,error,message,headers){return error_1.APIError.generate(status,error,message,headers)}request(options,remainingRetries=null){return new APIPromise(this.makeRequest(options,remainingRetries))}async makeRequest(optionsInput,retriesRemaining){var optionsInput=await optionsInput,{req:_a,url,timeout}=(null==retriesRemaining&&(retriesRemaining=null!=(_a=optionsInput.maxRetries)?_a:this.maxRetries),this.buildRequest(optionsInput));if(await this.prepareRequest(_a,{url:url,options:optionsInput}),debug("request",url,optionsInput,_a.headers),null!=(_b=optionsInput.signal)&&_b.aborted)throw new error_1.APIUserAbortError;var _b=new AbortController,_a=await this.fetchWithTimeout(url,_a,timeout,_b).catch(exports.castToError);if(_a instanceof Error){if(null!=(timeout=optionsInput.signal)&&timeout.aborted)throw new error_1.APIUserAbortError;if(retriesRemaining)return this.retryRequest(optionsInput,retriesRemaining);if("AbortError"===_a.name)throw new error_1.APIConnectionTimeoutError;throw new error_1.APIConnectionError({cause:_a})}timeout=(0,exports.createResponseHeaders)(_a.headers);if(_a.ok)return{response:_a,options:optionsInput,controller:_b};if(retriesRemaining&&this.shouldRetry(_a))return this.retryRequest(optionsInput,retriesRemaining,timeout);_b=await _a.text().catch(e=>(0,exports.castToError)(e).message),optionsInput=(0,exports.safeJSON)(_b),retriesRemaining=optionsInput?void 0:_b,debug("response",_a.status,url,timeout,retriesRemaining),_b=this.makeStatusError(_a.status,optionsInput,retriesRemaining,timeout);throw _b}requestAPIList(Page,options){options=this.makeRequest(options,null);return new PagePromise(this,options,Page)}buildURL(path,query){var path=isAbsoluteURL(path)?new URL(path):new URL(this.baseURL+(this.baseURL.endsWith("/")&&path.startsWith("/")?path.slice(1):path)),defaultQuery=this.defaultQuery();return(query=isEmptyObj(defaultQuery)?query:{...defaultQuery,...query})&&(path.search=this.stringifyQuery(query)),path.toString()}stringifyQuery(query){return Object.entries(query).filter(([,value])=>void 0!==value).map(([key,value])=>{if("string"==typeof value||"number"==typeof value||"boolean"==typeof value)return encodeURIComponent(key)+"="+encodeURIComponent(value);if(null===value)return encodeURIComponent(key)+"=";throw new error_1.OpenAIError(`Cannot stringify type ${typeof value}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(url,init,ms,controller){const{signal,...options}=init||{},timeout=(signal&&signal.addEventListener("abort",()=>controller.abort()),setTimeout(()=>controller.abort(),ms));return this.getRequestClient().fetch.call(void 0,url,{signal:controller.signal,...options}).finally(()=>{clearTimeout(timeout)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(response){var shouldRetryHeader=response.headers.get("x-should-retry");return"true"===shouldRetryHeader||"false"!==shouldRetryHeader&&(408===response.status||409===response.status||429===response.status||500<=response.status)}async retryRequest(options,retriesRemaining,responseHeaders){--retriesRemaining;let timeoutMillis;var timeoutSeconds,responseHeaders=null==responseHeaders?void 0:responseHeaders["retry-after"];return responseHeaders&&(timeoutSeconds=parseInt(responseHeaders),timeoutMillis=Number.isNaN(timeoutSeconds)?Date.parse(responseHeaders)-Date.now():1e3*timeoutSeconds),(!timeoutMillis||!Number.isInteger(timeoutMillis)||timeoutMillis<=0||6e4<timeoutMillis)&&(timeoutSeconds=null!=(responseHeaders=options.maxRetries)?responseHeaders:this.maxRetries,timeoutMillis=this.calculateDefaultRetryTimeoutMillis(retriesRemaining,timeoutSeconds)),await(0,exports.sleep)(timeoutMillis),this.makeRequest(options,retriesRemaining)}calculateDefaultRetryTimeoutMillis(retriesRemaining,maxRetries){return 1e3*(Math.min(.5*Math.pow(maxRetries-retriesRemaining-1,2),2)+(Math.random()-.5))}getUserAgent(){return this.constructor.name+"/JS "+version_1.VERSION}};exports.APIResource=class{constructor(client){this.client=client,this.get=client.get.bind(client),this.post=client.post.bind(client),this.patch=client.patch.bind(client),this.put=client.put.bind(client),this.delete=client.delete.bind(client),this.getAPIList=client.getAPIList.bind(client)}};class AbstractPage{constructor(client,response,body,options){_AbstractPage_client.set(this,void 0),__classPrivateFieldSet(this,_AbstractPage_client,client,"f"),this.options=options,this.response=response,this.body=body}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){var nextInfo=this.nextPageInfo();if(!nextInfo)throw new error_1.OpenAIError("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");var key,value,nextOptions={...this.options};if("params"in nextInfo)nextOptions.query={...nextOptions.query,...nextInfo.params};else if("url"in nextInfo){for([key,value]of[...Object.entries(nextOptions.query||{}),...nextInfo.url.searchParams.entries()])nextInfo.url.searchParams.set(key,value);nextOptions.query=void 0,nextOptions.path=nextInfo.url.toString()}return __classPrivateFieldGet(this,_AbstractPage_client,"f").requestAPIList(this.constructor,nextOptions)}async*iterPages(){let page=this;for(yield page;page.hasNextPage();)yield page=await page.getNextPage()}async*[(_AbstractPage_client=new WeakMap,Symbol.asyncIterator)](){for await(const page of this.iterPages())for(const item of page.getPaginatedItems())yield item}}exports.AbstractPage=AbstractPage;class PagePromise extends APIPromise{constructor(client,request,Page){super(request,async props=>new Page(client,props.response,await defaultParseResponse(props),props.options))}async*[Symbol.asyncIterator](){for await(const item of await this)yield item}}exports.PagePromise=PagePromise;exports.createResponseHeaders=headers=>new Proxy(Object.fromEntries(headers.entries()),{get(target,name){name=name.toString();return target[name.toLowerCase()]||target[name]}});const requestOptionsKeys={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0};exports.isRequestOptions=obj=>"object"==typeof obj&&null!==obj&&!isEmptyObj(obj)&&Object.keys(obj).every(k=>hasOwn(requestOptionsKeys,k));const getPlatformProperties=()=>{var browserInfo;return"undefined"!=typeof Deno&&null!=Deno.build?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":version_1.VERSION,"X-Stainless-OS":normalizePlatform(Deno.build.os),"X-Stainless-Arch":normalizeArch(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version}:"undefined"!=typeof EdgeRuntime?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":version_1.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"other:"+EdgeRuntime,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version}:"[object process]"===Object.prototype.toString.call(void 0!==process?process:0)?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":version_1.VERSION,"X-Stainless-OS":normalizePlatform(process.platform),"X-Stainless-Arch":normalizeArch(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version}:(browserInfo=function(){if("undefined"!=typeof navigator&&navigator){var key,pattern;for({key,pattern}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){var major,minor,match=pattern.exec(navigator.userAgent);if(match)return major=match[1]||0,minor=match[2]||0,match=match[3]||0,{browser:key,version:major+`.${minor}.`+match}}}return null}())?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":version_1.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"browser:"+browserInfo.browser,"X-Stainless-Runtime-Version":browserInfo.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":version_1.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const normalizeArch=arch=>"x32"===arch?"x32":"x86_64"===arch||"x64"===arch?"x64":"arm"===arch?"arm":"aarch64"===arch||"arm64"===arch?"arm64":arch?"other:"+arch:"unknown",normalizePlatform=platform=>(platform=platform.toLowerCase()).includes("ios")?"iOS":"android"===platform?"Android":"darwin"===platform?"MacOS":"win32"===platform?"Windows":"freebsd"===platform?"FreeBSD":"openbsd"===platform?"OpenBSD":"linux"===platform?"Linux":platform?"Other:"+platform:"Unknown";let _platformHeaders;const getPlatformHeaders=()=>null!==_platformHeaders&&void 0!==_platformHeaders?_platformHeaders:_platformHeaders=getPlatformProperties();exports.safeJSON=text=>{try{return JSON.parse(text)}catch(err){}};const startsWithSchemeRegexp=new RegExp("^(?:[a-z]+:)?//","i"),isAbsoluteURL=url=>startsWithSchemeRegexp.test(url);exports.sleep=ms=>new Promise(resolve=>setTimeout(resolve,ms));const validatePositiveInteger=(name,n)=>{if("number"!=typeof n||!Number.isInteger(n))throw new error_1.OpenAIError(name+" must be an integer");if(n<0)throw new error_1.OpenAIError(name+" must be a positive integer");return n};exports.castToError=err=>err instanceof Error?err:new Error(err),exports.ensurePresent=value=>{if(null==value)throw new error_1.OpenAIError(`Expected a value to be given but received ${value} instead.`);return value},exports.readEnv=env=>{var _a,_d;return void 0!==process?null!=(_a=null==(_a=process.env)?void 0:_a[env])?_a:void 0:"undefined"==typeof Deno||null==(_d=null==(_a=Deno.env)?void 0:_a.get)?void 0:_d.call(_a,env)},exports.coerceInteger=value=>{if("number"==typeof value)return Math.round(value);if("string"==typeof value)return parseInt(value,10);throw new error_1.OpenAIError(`Could not coerce ${value} (type: ${typeof value}) into a number`)},exports.coerceFloat=value=>{if("number"==typeof value)return value;if("string"==typeof value)return parseFloat(value);throw new error_1.OpenAIError(`Could not coerce ${value} (type: ${typeof value}) into a number`)},exports.coerceBoolean=value=>"boolean"==typeof value?value:"string"==typeof value?"true"===value:Boolean(value),exports.maybeCoerceInteger=value=>{if(void 0!==value)return(0,exports.coerceInteger)(value)},exports.maybeCoerceFloat=value=>{if(void 0!==value)return(0,exports.coerceFloat)(value)};function isEmptyObj(obj){if(obj)for(const _k in obj)return!1;return!0}function hasOwn(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}function debug(action,...args){void 0!==process&&"true"===process.env.DEBUG&&console.log("OpenAI:DEBUG:"+action,...args)}exports.maybeCoerceBoolean=value=>{if(void 0!==value)return(0,exports.coerceBoolean)(value)},exports.isEmptyObj=isEmptyObj,exports.hasOwn=hasOwn,exports.debug=debug;const uuid4=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,c=>{var r=16*Math.random()|0;return("x"===c?r:3&r|8).toString(16)});exports.isRunningInBrowser=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator,exports.isHeadersProtocol=headers=>"function"==typeof(null==headers?void 0:headers.get),exports.getHeader=(headers,key)=>{var lowerKey=key.toLowerCase();return(0,exports.isHeadersProtocol)(headers)?headers.get(key)||headers.get(lowerKey):(headers=headers[key]||headers[lowerKey],Array.isArray(headers)?(headers.length<=1||console.warn(`Received ${headers.length} entries for the ${key} header, using the first entry.`),headers[0]):headers)};exports.toBase64=str=>{if(!str)return"";if(void 0!==Buffer)return Buffer.from(str).toString("base64");if("undefined"!=typeof btoa)return btoa(str);throw new error_1.OpenAIError("Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined")}}.call(this)}.call(this,require("_process"),require("buffer").Buffer)},{"./_shims/index.js":8,"./error.js":12,"./streaming.js":35,"./uploads.js":36,"./version.js":37,_process:38,buffer:3}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InternalServerError=exports.RateLimitError=exports.UnprocessableEntityError=exports.ConflictError=exports.NotFoundError=exports.PermissionDeniedError=exports.AuthenticationError=exports.BadRequestError=exports.APIConnectionTimeoutError=exports.APIConnectionError=exports.APIUserAbortError=exports.APIError=exports.OpenAIError=void 0;const core_1=require("./core.js");class OpenAIError extends Error{}class APIError extends(exports.OpenAIError=OpenAIError){constructor(status,error,message,headers){super(status+" "+APIError.makeMessage(error,message)),this.status=status,this.headers=headers;message=error;this.error=message,this.code=null==message?void 0:message.code,this.param=null==message?void 0:message.param,this.type=null==message?void 0:message.type}static makeMessage(error,message){return null!=error&&error.message?"string"==typeof error.message?error.message:JSON.stringify(error.message):error?JSON.stringify(error):message||"status code (no body)"}static generate(status,errorResponse,message,headers){var error;return status?(error=null==errorResponse?void 0:errorResponse.error,new(400===status?BadRequestError:401===status?AuthenticationError:403===status?PermissionDeniedError:404===status?NotFoundError:409===status?ConflictError:422===status?UnprocessableEntityError:429===status?RateLimitError:500<=status?InternalServerError:APIError)(status,error,message,headers)):new APIConnectionError({cause:(0,core_1.castToError)(errorResponse)})}}class APIUserAbortError extends(exports.APIError=APIError){constructor({message}={}){super(void 0,void 0,message||"Request was aborted.",void 0),this.status=void 0}}exports.APIUserAbortError=APIUserAbortError;class APIConnectionError extends APIError{constructor({message,cause}){super(void 0,void 0,message||"Connection error.",void 0),this.status=void 0,cause&&(this.cause=cause)}}class APIConnectionTimeoutError extends(exports.APIConnectionError=APIConnectionError){constructor({message}={}){super({message:null!=message?message:"Request timed out."})}}exports.APIConnectionTimeoutError=APIConnectionTimeoutError;class BadRequestError extends APIError{constructor(){super(...arguments),this.status=400}}exports.BadRequestError=BadRequestError;class AuthenticationError extends APIError{constructor(){super(...arguments),this.status=401}}exports.AuthenticationError=AuthenticationError;class PermissionDeniedError extends APIError{constructor(){super(...arguments),this.status=403}}exports.PermissionDeniedError=PermissionDeniedError;class NotFoundError extends APIError{constructor(){super(...arguments),this.status=404}}exports.NotFoundError=NotFoundError;class ConflictError extends APIError{constructor(){super(...arguments),this.status=409}}exports.ConflictError=ConflictError;class UnprocessableEntityError extends APIError{constructor(){super(...arguments),this.status=422}}exports.UnprocessableEntityError=UnprocessableEntityError;class RateLimitError extends APIError{constructor(){super(...arguments),this.status=429}}exports.RateLimitError=RateLimitError;class InternalServerError extends APIError{}exports.InternalServerError=InternalServerError},{"./core.js":11}],13:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&("get"in desc?m.__esModule:!desc.writable&&!desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){o[k2=void 0===k2?k:k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.fileFromPath=exports.toFile=exports.UnprocessableEntityError=exports.PermissionDeniedError=exports.InternalServerError=exports.AuthenticationError=exports.BadRequestError=exports.RateLimitError=exports.ConflictError=exports.NotFoundError=exports.APIUserAbortError=exports.APIConnectionTimeoutError=exports.APIConnectionError=exports.APIError=exports.OpenAIError=exports.OpenAI=void 0;const Core=__importStar(require("./core.js")),Pagination=__importStar(require("./pagination.js")),API=__importStar(require("./resources/index.js")),Errors=__importStar(require("./error.js")),Uploads=__importStar(require("./uploads.js"));class OpenAI extends Core.APIClient{constructor(_b){var _e,{apiKey:_b=Core.readEnv("OPENAI_API_KEY"),organization:_c=null!=(_c=Core.readEnv("OPENAI_ORG_ID"))?_c:null,...opts}=void 0===_b?{}:_b;if(void 0===_b)throw new Errors.OpenAIError("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'my apiKey' }).");opts={apiKey:_b,organization:_c,...opts,baseURL:null!=(opts=opts.baseURL)?opts:"https://api.openai.com/v1"};if(!opts.dangerouslyAllowBrowser&&Core.isRunningInBrowser())throw new Errors.OpenAIError("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:opts.baseURL,timeout:null!=(_e=opts.timeout)?_e:6e5,httpAgent:opts.httpAgent,maxRetries:opts.maxRetries,fetch:opts.fetch}),this.completions=new API.Completions(this),this.chat=new API.Chat(this),this.edits=new API.Edits(this),this.embeddings=new API.Embeddings(this),this.files=new API.Files(this),this.images=new API.Images(this),this.audio=new API.Audio(this),this.moderations=new API.Moderations(this),this.models=new API.Models(this),this.fineTuning=new API.FineTuning(this),this.fineTunes=new API.FineTunes(this),this._options=opts,this.apiKey=_b,this.organization=_c}defaultQuery(){return this._options.defaultQuery}defaultHeaders(opts){return{...super.defaultHeaders(opts),"OpenAI-Organization":this.organization,...this._options.defaultHeaders}}authHeaders(opts){return{Authorization:"Bearer "+this.apiKey}}}(__importStar=exports.OpenAI=OpenAI).OpenAI=__importStar,OpenAI.OpenAIError=Errors.OpenAIError,OpenAI.APIError=Errors.APIError,OpenAI.APIConnectionError=Errors.APIConnectionError,OpenAI.APIConnectionTimeoutError=Errors.APIConnectionTimeoutError,OpenAI.APIUserAbortError=Errors.APIUserAbortError,OpenAI.NotFoundError=Errors.NotFoundError,OpenAI.ConflictError=Errors.ConflictError,OpenAI.RateLimitError=Errors.RateLimitError,OpenAI.BadRequestError=Errors.BadRequestError,OpenAI.AuthenticationError=Errors.AuthenticationError,OpenAI.InternalServerError=Errors.InternalServerError,OpenAI.PermissionDeniedError=Errors.PermissionDeniedError,OpenAI.UnprocessableEntityError=Errors.UnprocessableEntityError,exports.OpenAIError=Errors.OpenAIError,exports.APIError=Errors.APIError,exports.APIConnectionError=Errors.APIConnectionError,exports.APIConnectionTimeoutError=Errors.APIConnectionTimeoutError,exports.APIUserAbortError=Errors.APIUserAbortError,exports.NotFoundError=Errors.NotFoundError,exports.ConflictError=Errors.ConflictError,exports.RateLimitError=Errors.RateLimitError,exports.BadRequestError=Errors.BadRequestError,exports.AuthenticationError=Errors.AuthenticationError,exports.InternalServerError=Errors.InternalServerError,exports.PermissionDeniedError=Errors.PermissionDeniedError,exports.UnprocessableEntityError=Errors.UnprocessableEntityError,exports.toFile=Uploads.toFile,exports.fileFromPath=Uploads.fileFromPath,function(OpenAI){OpenAI.toFile=Uploads.toFile,OpenAI.fileFromPath=Uploads.fileFromPath,OpenAI.Page=Pagination.Page,OpenAI.CursorPage=Pagination.CursorPage,OpenAI.Completions=API.Completions,OpenAI.Chat=API.Chat,OpenAI.Edits=API.Edits,OpenAI.Embeddings=API.Embeddings,OpenAI.Files=API.Files,OpenAI.FileObjectsPage=API.FileObjectsPage,OpenAI.Images=API.Images,OpenAI.Audio=API.Audio,OpenAI.Moderations=API.Moderations,OpenAI.Models=API.Models,OpenAI.ModelsPage=API.ModelsPage,OpenAI.FineTuning=API.FineTuning,OpenAI.FineTunes=API.FineTunes,OpenAI.FineTunesPage=API.FineTunesPage}(OpenAI=exports.OpenAI||(exports.OpenAI={})),(exports=module.exports=OpenAI).default=OpenAI},{"./core.js":11,"./error.js":12,"./pagination.js":14,"./resources/index.js":32,"./uploads.js":36}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CursorPage=exports.Page=void 0;require=require("./core.js");class Page extends require.AbstractPage{constructor(client,response,body,options){super(client,response,body,options),this.object=body.object,this.data=body.data}getPaginatedItems(){return this.data}nextPageParams(){return null}nextPageInfo(){return null}}exports.Page=Page;class CursorPage extends require.AbstractPage{constructor(client,response,body,options){super(client,response,body,options),this.data=body.data}getPaginatedItems(){return this.data}nextPageParams(){var info=this.nextPageInfo();return info?"params"in info?info.params:(info=Object.fromEntries(info.url.searchParams),Object.keys(info).length?info:null):null}nextPageInfo(){var _a;return null!=(_a=this.data)&&_a.length&&(_a=null==(_a=this.data[this.data.length-1])?void 0:_a.id)?{params:{after:_a}}:null}}exports.CursorPage=CursorPage},{"./core.js":11}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.APIResource=void 0;exports.APIResource=class{constructor(client){this.client=client,this.get=client.get.bind(client),this.post=client.post.bind(client),this.patch=client.patch.bind(client),this.put=client.put.bind(client),this.delete=client.delete.bind(client),this.getAPIList=client.getAPIList.bind(client)}}},{}],16:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&("get"in desc?m.__esModule:!desc.writable&&!desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){o[k2=void 0===k2?k:k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},resource_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Audio=void 0,require("openai/resource"));const transcriptions_1=require("./transcriptions.js"),translations_1=require("./translations.js"),API=__importStar(require("./index.js"));class Audio extends resource_1.APIResource{constructor(){super(...arguments),this.transcriptions=new transcriptions_1.Transcriptions(this.client),this.translations=new translations_1.Translations(this.client)}}exports.Audio=Audio,function(Audio){Audio.Transcriptions=API.Transcriptions,Audio.Translations=API.Translations}(Audio=exports.Audio||(exports.Audio={}))},{"./index.js":17,"./transcriptions.js":18,"./translations.js":19,"openai/resource":15}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Translations=exports.Transcriptions=exports.Audio=void 0;var audio_1=require("./audio.js"),transcriptions_1=(Object.defineProperty(exports,"Audio",{enumerable:!0,get:function(){return audio_1.Audio}}),require("./transcriptions.js")),translations_1=(Object.defineProperty(exports,"Transcriptions",{enumerable:!0,get:function(){return transcriptions_1.Transcriptions}}),require("./translations.js"));Object.defineProperty(exports,"Translations",{enumerable:!0,get:function(){return translations_1.Translations}})},{"./audio.js":16,"./transcriptions.js":18,"./translations.js":19}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Transcriptions=void 0;var resource_1=require("openai/resource");const core_1=require("openai/core");class Transcriptions extends resource_1.APIResource{create(body,options){return this.post("/audio/transcriptions",(0,core_1.multipartFormRequestOptions)({body:body,...options}))}}exports.Transcriptions=Transcriptions,Transcriptions=exports.Transcriptions||(exports.Transcriptions={})},{"openai/core":11,"openai/resource":15}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Translations=void 0;var resource_1=require("openai/resource");const core_1=require("openai/core");class Translations extends resource_1.APIResource{create(body,options){return this.post("/audio/translations",(0,core_1.multipartFormRequestOptions)({body:body,...options}))}}exports.Translations=Translations,Translations=exports.Translations||(exports.Translations={})},{"openai/core":11,"openai/resource":15}],20:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&("get"in desc?m.__esModule:!desc.writable&&!desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){o[k2=void 0===k2?k:k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},resource_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.Chat=void 0,require("openai/resource"));const completions_1=require("./completions.js"),API=__importStar(require("./index.js"));class Chat extends resource_1.APIResource{constructor(){super(...arguments),this.completions=new completions_1.Completions(this.client)}}exports.Chat=Chat,function(Chat){Chat.Completions=API.Completions}(Chat=exports.Chat||(exports.Chat={}))},{"./completions.js":21,"./index.js":22,"openai/resource":15}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Completions=void 0;class Completions extends require("openai/resource").APIResource{create(body,options){return this.post("/chat/completions",{body:body,...options,stream:null!=(options=body.stream)&&options})}}exports.Completions=Completions,Completions=exports.Completions||(exports.Completions={})},{"openai/resource":15}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Completions=exports.Chat=void 0;var chat_1=require("./chat.js"),completions_1=(Object.defineProperty(exports,"Chat",{enumerable:!0,get:function(){return chat_1.Chat}}),require("./completions.js"));Object.defineProperty(exports,"Completions",{enumerable:!0,get:function(){return completions_1.Completions}})},{"./chat.js":20,"./completions.js":21}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Completions=void 0;class Completions extends require("openai/resource").APIResource{create(body,options){return this.post("/completions",{body:body,...options,stream:null!=(options=body.stream)&&options})}}exports.Completions=Completions,Completions=exports.Completions||(exports.Completions={})},{"openai/resource":15}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Edits=void 0;class Edits extends require("openai/resource").APIResource{create(body,options){return this.post("/edits",{body:body,...options})}}exports.Edits=Edits,Edits=exports.Edits||(exports.Edits={})},{"openai/resource":15}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Embeddings=void 0;class Embeddings extends require("openai/resource").APIResource{create(body,options){return this.post("/embeddings",{body:body,...options})}}exports.Embeddings=Embeddings,Embeddings=exports.Embeddings||(exports.Embeddings={})},{"openai/resource":15}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FileObjectsPage=exports.Files=void 0;var resource_1=require("openai/resource");const core_1=require("openai/core"),error_1=require("openai/error"),core_2=require("openai/core");require=require("openai/pagination");class Files extends resource_1.APIResource{create(body,options){return this.post("/files",(0,core_2.multipartFormRequestOptions)({body:body,...options}))}retrieve(fileId,options){return this.get("/files/"+fileId,options)}list(options){return this.getAPIList("/files",FileObjectsPage,options)}del(fileId,options){return this.delete("/files/"+fileId,options)}retrieveContent(fileId,options){return this.get(`/files/${fileId}/content`,{...options,headers:{Accept:"application/json",...null==options?void 0:options.headers}})}async waitForProcessing(id,{pollInterval=5e3,maxWait=18e5}={}){var TERMINAL_STATES=new Set(["processed","error","deleted"]),start=Date.now();let file=await this.retrieve(id);for(;!file.status||!TERMINAL_STATES.has(file.status);)if(await(0,core_1.sleep)(pollInterval),file=await this.retrieve(id),Date.now()-start>maxWait)throw new error_1.APIConnectionTimeoutError({message:`Giving up on waiting for file ${id} to finish processing after ${maxWait} milliseconds.`});return file}}exports.Files=Files;class FileObjectsPage extends require.Page{}exports.FileObjectsPage=FileObjectsPage,Files=exports.Files||(exports.Files={})},{"openai/core":11,"openai/error":12,"openai/pagination":14,"openai/resource":15}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FineTunesPage=exports.FineTunes=void 0;var resource_1=require("openai/resource"),require=require("openai/pagination");class FineTunes extends resource_1.APIResource{create(body,options){return this.post("/fine-tunes",{body:body,...options})}retrieve(fineTuneId,options){return this.get("/fine-tunes/"+fineTuneId,options)}list(options){return this.getAPIList("/fine-tunes",FineTunesPage,options)}cancel(fineTuneId,options){return this.post(`/fine-tunes/${fineTuneId}/cancel`,options)}listEvents(fineTuneId,query,options){return this.get(`/fine-tunes/${fineTuneId}/events`,{query:query,timeout:864e5,...options,stream:null!=(fineTuneId=null==query?void 0:query.stream)&&fineTuneId})}}exports.FineTunes=FineTunes;class FineTunesPage extends require.Page{}exports.FineTunesPage=FineTunesPage,FineTunes=exports.FineTunes||(exports.FineTunes={})},{"openai/pagination":14,"openai/resource":15}],28:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&("get"in desc?m.__esModule:!desc.writable&&!desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){o[k2=void 0===k2?k:k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},resource_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.FineTuning=void 0,require("openai/resource"));const jobs_1=require("./jobs.js"),API=__importStar(require("./index.js"));class FineTuning extends resource_1.APIResource{constructor(){super(...arguments),this.jobs=new jobs_1.Jobs(this.client)}}exports.FineTuning=FineTuning,function(FineTuning){FineTuning.Jobs=API.Jobs,FineTuning.FineTuningJobsPage=API.FineTuningJobsPage,FineTuning.FineTuningJobEventsPage=API.FineTuningJobEventsPage}(FineTuning=exports.FineTuning||(exports.FineTuning={}))},{"./index.js":29,"./jobs.js":30,"openai/resource":15}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Jobs=exports.FineTuningJobEventsPage=exports.FineTuningJobsPage=exports.FineTuning=void 0;var fine_tuning_1=require("./fine-tuning.js"),jobs_1=(Object.defineProperty(exports,"FineTuning",{enumerable:!0,get:function(){return fine_tuning_1.FineTuning}}),require("./jobs.js"));Object.defineProperty(exports,"FineTuningJobsPage",{enumerable:!0,get:function(){return jobs_1.FineTuningJobsPage}}),Object.defineProperty(exports,"FineTuningJobEventsPage",{enumerable:!0,get:function(){return jobs_1.FineTuningJobEventsPage}}),Object.defineProperty(exports,"Jobs",{enumerable:!0,get:function(){return jobs_1.Jobs}})},{"./fine-tuning.js":28,"./jobs.js":30}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FineTuningJobEventsPage=exports.FineTuningJobsPage=exports.Jobs=void 0;var resource_1=require("openai/resource");const core_1=require("openai/core");require=require("openai/pagination");class Jobs extends resource_1.APIResource{create(body,options){return this.post("/fine_tuning/jobs",{body:body,...options})}retrieve(fineTuningJobId,options){return this.get("/fine_tuning/jobs/"+fineTuningJobId,options)}list(query={},options){return(0,core_1.isRequestOptions)(query)?this.list({},query):this.getAPIList("/fine_tuning/jobs",FineTuningJobsPage,{query:query,...options})}cancel(fineTuningJobId,options){return this.post(`/fine_tuning/jobs/${fineTuningJobId}/cancel`,options)}listEvents(fineTuningJobId,query={},options){return(0,core_1.isRequestOptions)(query)?this.listEvents(fineTuningJobId,{},query):this.getAPIList(`/fine_tuning/jobs/${fineTuningJobId}/events`,FineTuningJobEventsPage,{query:query,...options})}}exports.Jobs=Jobs;class FineTuningJobsPage extends require.CursorPage{}exports.FineTuningJobsPage=FineTuningJobsPage;class FineTuningJobEventsPage extends require.CursorPage{}exports.FineTuningJobEventsPage=FineTuningJobEventsPage,Jobs=exports.Jobs||(exports.Jobs={})},{"openai/core":11,"openai/pagination":14,"openai/resource":15}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Images=void 0;var resource_1=require("openai/resource");const core_1=require("openai/core");class Images extends resource_1.APIResource{createVariation(body,options){return this.post("/images/variations",(0,core_1.multipartFormRequestOptions)({body:body,...options}))}edit(body,options){return this.post("/images/edits",(0,core_1.multipartFormRequestOptions)({body:body,...options}))}generate(body,options){return this.post("/images/generations",{body:body,...options})}}exports.Images=Images,Images=exports.Images||(exports.Images={})},{"openai/core":11,"openai/resource":15}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Moderations=exports.Models=exports.ModelsPage=exports.Images=exports.FineTuning=exports.FineTunes=exports.FineTunesPage=exports.Files=exports.FileObjectsPage=exports.Edits=exports.Embeddings=exports.Completions=exports.Chat=exports.Audio=void 0;var audio_1=require("./audio/audio.js"),chat_1=(Object.defineProperty(exports,"Audio",{enumerable:!0,get:function(){return audio_1.Audio}}),require("./chat/chat.js")),completions_1=(Object.defineProperty(exports,"Chat",{enumerable:!0,get:function(){return chat_1.Chat}}),require("./completions.js")),embeddings_1=(Object.defineProperty(exports,"Completions",{enumerable:!0,get:function(){return completions_1.Completions}}),require("./embeddings.js")),edits_1=(Object.defineProperty(exports,"Embeddings",{enumerable:!0,get:function(){return embeddings_1.Embeddings}}),require("./edits.js")),files_1=(Object.defineProperty(exports,"Edits",{enumerable:!0,get:function(){return edits_1.Edits}}),require("./files.js")),fine_tunes_1=(Object.defineProperty(exports,"FileObjectsPage",{enumerable:!0,get:function(){return files_1.FileObjectsPage}}),Object.defineProperty(exports,"Files",{enumerable:!0,get:function(){return files_1.Files}}),require("./fine-tunes.js")),fine_tuning_1=(Object.defineProperty(exports,"FineTunesPage",{enumerable:!0,get:function(){return fine_tunes_1.FineTunesPage}}),Object.defineProperty(exports,"FineTunes",{enumerable:!0,get:function(){return fine_tunes_1.FineTunes}}),require("./fine-tuning/fine-tuning.js")),images_1=(Object.defineProperty(exports,"FineTuning",{enumerable:!0,get:function(){return fine_tuning_1.FineTuning}}),require("./images.js")),models_1=(Object.defineProperty(exports,"Images",{enumerable:!0,get:function(){return images_1.Images}}),require("./models.js")),moderations_1=(Object.defineProperty(exports,"ModelsPage",{enumerable:!0,get:function(){return models_1.ModelsPage}}),Object.defineProperty(exports,"Models",{enumerable:!0,get:function(){return models_1.Models}}),require("./moderations.js"));Object.defineProperty(exports,"Moderations",{enumerable:!0,get:function(){return moderations_1.Moderations}})},{"./audio/audio.js":16,"./chat/chat.js":20,"./completions.js":23,"./edits.js":24,"./embeddings.js":25,"./files.js":26,"./fine-tunes.js":27,"./fine-tuning/fine-tuning.js":28,"./images.js":31,"./models.js":33,"./moderations.js":34}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModelsPage=exports.Models=void 0;var resource_1=require("openai/resource"),require=require("openai/pagination");class Models extends resource_1.APIResource{retrieve(model,options){return this.get("/models/"+model,options)}list(options){return this.getAPIList("/models",ModelsPage,options)}del(model,options){return this.delete("/models/"+model,options)}}exports.Models=Models;class ModelsPage extends require.Page{}exports.ModelsPage=ModelsPage,Models=exports.Models||(exports.Models={})},{"openai/pagination":14,"openai/resource":15}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Moderations=void 0;class Moderations extends require("openai/resource").APIResource{create(body,options){return this.post("/moderations",{body:body,...options})}}exports.Moderations=Moderations,Moderations=exports.Moderations||(exports.Moderations={})},{"openai/resource":15}],35:[function(require,module,exports){!function(Buffer){!function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Stream=void 0;const error_1=require("./error.js");class Stream{constructor(response,controller){this.response=response,this.controller=controller,this.decoder=new SSEDecoder}async*iterMessages(){if(!this.response.body)throw this.controller.abort(),new error_1.OpenAIError("Attempted to iterate over a response with no body");var lineDecoder=new LineDecoder;for await(const chunk of function(stream){if(stream[Symbol.asyncIterator])return stream;const reader=stream.getReader();return{async next(){try{var result=await reader.read();return null!=result&&result.done&&reader.releaseLock(),result}catch(e){throw reader.releaseLock(),e}},async return(){var cancelPromise=reader.cancel();return reader.releaseLock(),await cancelPromise,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}(this.response.body))for(const line of lineDecoder.decode(chunk)){var sse=this.decoder.decode(line);sse&&(yield sse)}for(const line of lineDecoder.flush()){const sse=this.decoder.decode(line);sse&&(yield sse)}}async*[Symbol.asyncIterator](){let done=!1;try{for await(const sse of this.iterMessages())if(!done)if(sse.data.startsWith("[DONE]"))done=!0;else if(null===sse.event)try{yield JSON.parse(sse.data)}catch(e){throw console.error("Could not parse message into JSON:",sse.data),console.error("From chunk:",sse.raw),e}done=!0}catch(e){if(!(e instanceof Error&&"AbortError"===e.name))throw e}finally{done||this.controller.abort()}}}exports.Stream=Stream;class SSEDecoder{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(line){var sse,index;if(!(line=line.endsWith("\r")?line.substring(0,line.length-1):line))return this.event||this.data.length?(sse={event:this.event,data:this.data.join("\n"),raw:this.chunks},this.event=null,this.data=[],this.chunks=[],sse):null;if(this.chunks.push(line),!line.startsWith(":")){sse=":";let[fieldname,,value]=-1===(index=(line=line).indexOf(sse))?[line,"",""]:[line.substring(0,index),sse,line.substring(index+sse.length)];value.startsWith(" ")&&(value=value.substring(1)),"event"===fieldname?this.event=value:"data"===fieldname&&this.data.push(value)}return null}}class LineDecoder{constructor(){this.buffer=[],this.trailingCR=!1}decode(chunk){let text=this.decodeText(chunk);if(this.trailingCR&&(text="\r"+text,this.trailingCR=!1),text.endsWith("\r")&&(this.trailingCR=!0,text=text.slice(0,-1)),!text)return[];chunk=LineDecoder.NEWLINE_CHARS.has(text[text.length-1]||"");let lines=text.split(LineDecoder.NEWLINE_REGEXP);return 1!==lines.length||chunk?(0<this.buffer.length&&(lines=[this.buffer.join("")+lines[0],...lines.slice(1)],this.buffer=[]),chunk||(this.buffer=[lines.pop()||""]),lines):(this.buffer.push(lines[0]),[])}decodeText(bytes){if(null==bytes)return"";if("string"==typeof bytes)return bytes;if(void 0!==Buffer){if(bytes instanceof Buffer)return bytes.toString();if(bytes instanceof Uint8Array)return Buffer.from(bytes).toString();throw new error_1.OpenAIError(`Unexpected: received non-Uint8Array (${bytes.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"==typeof TextDecoder)throw new error_1.OpenAIError("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.");if(bytes instanceof Uint8Array||bytes instanceof ArrayBuffer)return null==this.textDecoder&&(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(bytes);throw new error_1.OpenAIError(`Unexpected: received non-Uint8Array/ArrayBuffer (${bytes.constructor.name}) in a web platform. Please report this error.`)}flush(){var lines;return this.buffer.length||this.trailingCR?(lines=[this.buffer.join("")],this.buffer=[],this.trailingCR=!1,lines):[]}}LineDecoder.NEWLINE_CHARS=new Set(["\n","\r","\v","\f","","","","","\u2028","\u2029"]),LineDecoder.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g}.call(this)}.call(this,require("buffer").Buffer)},{"./error.js":12,buffer:3}],36:[function(require,module,exports){!function(Buffer){!function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createForm=exports.multipartFormRequestOptions=exports.maybeMultipartFormRequestOptions=exports.isMultipartBody=exports.toFile=exports.isUploadable=exports.isBlobLike=exports.isFileLike=exports.isResponseLike=exports.fileFromPath=void 0;const index_1=require("./_shims/index.js");var index_2=require("./_shims/index.js");Object.defineProperty(exports,"fileFromPath",{enumerable:!0,get:function(){return index_2.fileFromPath}}),exports.isResponseLike=value=>null!=value&&"object"==typeof value&&"string"==typeof value.url&&"function"==typeof value.blob,exports.isFileLike=value=>null!=value&&"object"==typeof value&&"string"==typeof value.name&&"number"==typeof value.lastModified&&(0,exports.isBlobLike)(value),exports.isBlobLike=value=>null!=value&&"object"==typeof value&&"number"==typeof value.size&&"string"==typeof value.type&&"function"==typeof value.text&&"function"==typeof value.slice&&"function"==typeof value.arrayBuffer;async function toFile(value,name,options={}){var _a,blob;return value=await value,(0,exports.isResponseLike)(value)?(blob=await value.blob(),name=name||(null!=(_a=new URL(value.url).pathname.split(/[\\/]/).pop())?_a:"unknown_file"),new index_1.File([blob],name,options)):(_a=await async function(value){var _a;var parts=[];if("string"==typeof value||ArrayBuffer.isView(value)||value instanceof ArrayBuffer)parts.push(value);else if((0,exports.isBlobLike)(value))parts.push(await value.arrayBuffer());else{if(!isAsyncIterableIterator(value))throw new Error(`Unexpected data type: ${typeof value}; constructor: ${null==(_a=null==value?void 0:value.constructor)?void 0:_a.name}; props: `+function(value){value=Object.getOwnPropertyNames(value);return`[${value.map(p=>`"${p}"`).join(", ")}]`}(value));for await(const chunk of value)parts.push(chunk)}return parts}(value),name=name||(null!=(blob=function(value){return getStringFromMaybeBuffer(value.name)||getStringFromMaybeBuffer(value.filename)||(null==(value=getStringFromMaybeBuffer(value.path))?void 0:value.split(/[\\/]/).pop())}(value))?blob:"unknown_file"),options.type||"string"==typeof(blob=null==(value=_a[0])?void 0:value.type)&&(options={...options,type:blob}),new index_1.File(_a,name,options))}exports.isUploadable=value=>(0,exports.isFileLike)(value)||(0,exports.isResponseLike)(value)||(0,index_1.isFsReadStream)(value),exports.toFile=toFile;const getStringFromMaybeBuffer=x=>"string"==typeof x?x:void 0!==Buffer&&x instanceof Buffer?String(x):void 0,isAsyncIterableIterator=value=>null!=value&&"object"==typeof value&&"function"==typeof value[Symbol.asyncIterator];exports.isMultipartBody=body=>body&&"object"==typeof body&&body.body&&"MultipartBody"===body[Symbol.toStringTag],exports.maybeMultipartFormRequestOptions=async opts=>{var form;return hasUploadableValue(opts.body)?(form=await(0,exports.createForm)(opts.body),(0,index_1.getMultipartRequestOptions)(form,opts)):opts},exports.multipartFormRequestOptions=async opts=>{var form=await(0,exports.createForm)(opts.body);return(0,index_1.getMultipartRequestOptions)(form,opts)};exports.createForm=async body=>{const form=new index_1.FormData;return await Promise.all(Object.entries(body||{}).map(([key,value])=>addFormValue(form,key,value))),form};const hasUploadableValue=value=>{if((0,exports.isUploadable)(value))return!0;if(Array.isArray(value))return value.some(hasUploadableValue);if(value&&"object"==typeof value)for(const k in value)if(hasUploadableValue(value[k]))return!0;return!1},addFormValue=async(form,key,value)=>{if(void 0!==value){if(null==value)throw new TypeError(`Received null for "${key}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof value||"number"==typeof value||"boolean"==typeof value)form.append(key,String(value));else if((0,exports.isUploadable)(value)){var file=await toFile(value);form.append(key,file)}else if(Array.isArray(value))await Promise.all(value.map(entry=>addFormValue(form,key+"[]",entry)));else{if("object"!=typeof value)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${value} instead`);await Promise.all(Object.entries(value).map(([name,prop])=>addFormValue(form,key+`[${name}]`,prop)))}}}}.call(this)}.call(this,require("buffer").Buffer)},{"./_shims/index.js":8,buffer:3}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=void 0,exports.VERSION="4.11.1"},{}],38:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,module=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return(cachedSetTimeout=setTimeout)(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length)&&drainQueue()}function drainQueue(){if(!draining){for(var timeout=runTimeout(cleanUpNextTick),len=(draining=!0,queue.length);len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,!function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return(cachedClearTimeout=clearTimeout)(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}module.nextTick=function(fun){var args=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},module.title="browser",module.browser=!0,module.env={},module.argv=[],module.version="",module.versions={},module.on=noop,module.addListener=noop,module.once=noop,module.off=noop,module.removeListener=noop,module.removeAllListeners=noop,module.emit=noop,module.prependListener=noop,module.prependOnceListener=noop,module.listeners=function(name){return[]},module.binding=function(name){throw new Error("process.binding is not supported")},module.cwd=function(){return"/"},module.chdir=function(dir){throw new Error("process.chdir is not supported")},module.umask=function(){return 0}},{}],39:[function(require,module,exports){var root,factory;root=this,factory=function(){"use strict";var useCssAnimations,prefixes=["webkit","Moz","ms","O"],animations={};function createEl(tag,prop){var n,el=document.createElement(tag||"div");for(n in prop)el[n]=prop[n];return el}function ins(parent){for(var i=1,n=arguments.length;i<n;i++)parent.appendChild(arguments[i]);return parent}function vendor(el,prop){var pp,i,s=el.style;if(void 0!==s[prop=prop.charAt(0).toUpperCase()+prop.slice(1)])return prop;for(i=0;i<prefixes.length;i++)if(void 0!==s[pp=prefixes[i]+prop])return pp}function css(el,prop){for(var n in prop)el.style[vendor(el,n)||n]=prop[n];return el}function merge(obj){for(var i=1;i<arguments.length;i++){var n,def=arguments[i];for(n in def)void 0===obj[n]&&(obj[n]=def[n])}return obj}function getColor(color,idx){return"string"==typeof color?color:color[idx%color.length]}var sheet,el,defaults={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};function Spinner(o){this.opts=merge(o||{},Spinner.defaults,defaults)}function vml(tag,attr){return createEl("<"+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr)}return Spinner.defaults={},merge(Spinner.prototype,{spin:function(target){this.stop();var i,start,alpha,fps,f,ostep,astep,self=this,o=self.opts,el=self.el=createEl(null,{className:o.className});return css(el,{position:o.position,width:0,zIndex:o.zIndex,left:o.left,top:o.top}),target&&target.insertBefore(el,target.firstChild||null),el.setAttribute("role","progressbar"),self.lines(el,self.opts),useCssAnimations||(i=0,start=(o.lines-1)*(1-o.direction)/2,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines,function anim(){i++;for(var j=0;j<o.lines;j++)alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity),self.opacity(el,j*o.direction+start,alpha,o);self.timeout=self.el&&setTimeout(anim,~~(1e3/fps))}()),self},stop:function(){var el=this.el;return el&&(clearTimeout(this.timeout),el.parentNode&&el.parentNode.removeChild(el),this.el=void 0),this},lines:function(el,o){var seg,i=0,start=(o.lines-1)*(1-o.direction)/2;function fill(color,shadow){return css(createEl(),{position:"absolute",width:o.scale*(o.length+o.width)+"px",height:o.scale*o.width+"px",background:color,boxShadow:shadow,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*i+o.rotate)+"deg) translate("+o.scale*o.radius+"px,0)",borderRadius:(o.corners*o.scale*o.width>>1)+"px"})}for(;i<o.lines;i++)seg=css(createEl(),{position:"absolute",top:1+~(o.scale*o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:useCssAnimations&&function(alpha,trail,i,lines){var name=["opacity",trail,~~(100*alpha),i,lines].join("-"),i=.01+i/lines*100,lines=Math.max(1-(1-alpha)/trail*(100-i),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf("Animation")).toLowerCase();return animations[name]||(sheet.insertRule("@"+(prefix&&"-"+prefix+"-"||"")+"keyframes "+name+"{0%{opacity:"+lines+"}"+i+"%{opacity:"+alpha+"}"+(.01+i)+"%{opacity:1}"+(i+trail)%100+"%{opacity:"+alpha+"}100%{opacity:"+lines+"}}",sheet.cssRules.length),animations[name]=1),name}(o.opacity,o.trail,start+i*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&ins(seg,css(fill("#000","0 0 4px #000"),{top:"2px"})),ins(el,ins(seg,fill(getColor(o.color,i),"0 0 1px rgba(0,0,0,.1)")));return el},opacity:function(el,i,val){i<el.childNodes.length&&(el.childNodes[i].style.opacity=val)}}),"undefined"!=typeof document&&(el=createEl("style",{type:"text/css"}),ins(document.getElementsByTagName("head")[0],el),sheet=el.sheet||el.styleSheet,!vendor(el=css(createEl("group"),{behavior:"url(#default#VML)"}),"transform")&&el.adj?(sheet.addRule(".spin-vml","behavior:url(#default#VML)"),Spinner.prototype.lines=function(el,o){var r=o.scale*(o.length+o.width),s=2*o.scale*r;function grp(){return css(vml("group",{coordsize:s+" "+s,coordorigin:-r+" "+-r}),{width:s,height:s})}var i,margin=-(o.width+o.length)*o.scale*2+"px",g=css(grp(),{position:"absolute",top:margin,left:margin});function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+"deg",left:~~dx}),ins(css(vml("roundrect",{arcsize:o.corners}),{width:r,height:o.scale*o.width,left:o.scale*o.radius,top:-o.scale*o.width>>1,filter:filter}),vml("fill",{color:getColor(o.color,i),opacity:o.opacity}),vml("stroke",{opacity:0}))))}if(o.shadow)for(i=1;i<=o.lines;i++)seg(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=o.lines;i++)seg(i);return ins(el,g)},Spinner.prototype.opacity=function(el,i,val,o){el=el.firstChild;o=o.shadow&&o.lines||0,el&&i+o<el.childNodes.length&&(el=(el=(el=el.childNodes[i+o])&&el.firstChild)&&el.firstChild)&&(el.opacity=val)}):useCssAnimations=vendor(el,"animation")),Spinner},"object"==typeof module&&module.exports?module.exports=factory():"function"==typeof define&&define.amd?define(factory):root.Spinner=factory()},{}]},{},[1]);
//# sourceMappingURL=scripts.min.js.map